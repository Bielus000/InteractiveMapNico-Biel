<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Mapa - Noctara</title>
  <link rel="stylesheet" href="css/map.css">
</head>

<body>
  <!-- Logo home button -->
  <a href="index.html" class="home-logo" aria-label="Volver al inicio">
    <img src="img/logo2.png" alt="Noctara">
  </a>

  <!-- Map container -->
  <div class="map-container">
    <svg id="mapSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080">
      <defs>
        <!-- Define las imágenes como patrones -->
        <pattern id="mapLayer1" patternUnits="userSpaceOnUse" width="1920" height="1080">
          <image href="img/map.jpeg" x="0" y="0" width="1920" height="1080" preserveAspectRatio="xMidYMid slice"/>
        </pattern>
        <pattern id="mapLayer2" patternUnits="userSpaceOnUse" width="1920" height="1080">
          <image href="img/map2.jpeg" x="0" y="0" width="1920" height="1080" preserveAspectRatio="xMidYMid slice"/>
        </pattern>
      </defs>
      
      <!-- Capa base (map.jpeg) -->
      <rect id="layer1" x="0" y="0" width="1920" height="1080" fill="url(#mapLayer1)"/>
      
      <!-- Icones visibles a la primera capa (ciutat i capital) -->
      <g id="layer1Icons">
        <!-- Ciutat (ajusta data-x/data-y a la posició desitjada) -->
        <g class="marker" data-x="620" data-y="360" data-name="Ciutat (capa 1)" data-icon="ciudad">
          <image href="img/icon-ciudad.png" x="604" y="344" width="32" height="32" preserveAspectRatio="xMidYMid meet"/>
        </g>
        <!-- Capital (ajusta data-x/data-y a la posició desitjada) -->
        <g class="marker" data-x="1320" data-y="720" data-name="Capital (capa 1)" data-icon="capital">
          <image href="img/icon-capital.png" x="1304" y="704" width="32" height="32" preserveAspectRatio="xMidYMid meet"/>
        </g>
      </g>
      
      <!-- Capa de detalle (map2.jpeg) - se muestra al hacer zoom -->
      <rect id="layer2" x="0" y="0" width="1920" height="1080" fill="url(#mapLayer2)" opacity="0"/>
      
      <!-- Grupo de marcadores - aparecen con zoom -->
      <g id="markersGroup" opacity="0">
        <!-- Marcador ejemplo: Capital - Coordenadas (960, 540) -->
        <g class="marker" data-x="960" data-y="540" data-name="Capital Central" data-icon="capital">
          <image href="img/icon-capital.png" x="944" y="524" width="32" height="32" preserveAspectRatio="xMidYMid meet"/>
        </g>
        
        <!-- Marcador ejemplo: Ciudad - Coordenadas (480, 270) -->
        <g class="marker" data-x="480" data-y="270" data-name="Ciudad Norte" data-icon="ciudad">
          <image href="img/icon-ciudad.png" x="464" y="254" width="32" height="32" preserveAspectRatio="xMidYMid meet"/>
        </g>
        
        <!-- Marcador ejemplo: Batalla - Coordenadas (1440, 810) -->
        <g class="marker" data-x="1440" data-y="810" data-name="Campo de Batalla" data-icon="batalla">
          <image href="img/icon-batalla.png" x="1424" y="794" width="32" height="32" preserveAspectRatio="xMidYMid meet"/>
        </g>
        
        <!-- Marcador ejemplo: Punto de interés - Coordenadas (1200, 400) -->
        <g class="marker" data-x="1200" data-y="400" data-name="Lugar de Interés" data-icon="interes">
          <image href="img/icon-interes.png" x="1184" y="384" width="32" height="32" preserveAspectRatio="xMidYMid meet"/>
        </g>
      </g>
    </svg>
  </div>

  <!-- Leyenda flotante -->
  <aside class="legend" id="legend">
    <div class="legend-header">
      <strong>Llegenda</strong>
      <button id="legendClose" aria-label="Amaga la llegenda">×</button>
    </div>
    <ul class="legend-list">
      <li><img src="img/icon-capital.png" alt="Capital"> Capital</li>
      <li><img src="img/icon-ciudad.png" alt="Ciutat"> Ciutat</li>
      <li><img src="img/icon-pueblo.png" alt="Poble"> Poble</li>
      <li><img src="img/icon-batalla.png" alt="Batalla"> Batalla</li>
      <li><img src="img/icon-interes.png" alt="Interès"> Punt d'interès</li>
      <li><img src="img/icon-info.png" alt="Info"> Informació</li>
    </ul>
  </aside>

  <!-- Botó per reobrir llegenda quan està amagada -->
  <button class="legend-toggle" id="legendToggle" aria-label="Mostra la llegenda" hidden>◀</button>

  <!-- Controles de zoom -->
  <div class="zoom-controls">
    <button id="zoomIn" aria-label="Acercar zoom">+</button>
    <button id="zoomReset" aria-label="Restablecer zoom">⊙</button>
    <button id="zoomOut" aria-label="Alejar zoom">−</button>
  </div>

  <!-- Info tooltip para marcadores -->
  <div id="markerTooltip" class="marker-tooltip" hidden></div>

  <!-- Panel lateral per info de marcador -->
  <div id="sideOverlay" class="side-overlay" hidden></div>
  <aside id="sidePanel" class="side-panel" aria-hidden="true">
    <div class="side-panel-header">
      <h3 id="panelTitle">Detall</h3>
      <button id="panelClose" aria-label="Tanca el panell">×</button>
    </div>
    <div id="panelBody" class="side-panel-body">
      <!-- Contingut dinàmic del marcador -->
    </div>
  </aside>

  <script src="js/map.js" defer></script>
  <script src="js/markers.js" defer></script>
</body>
</html>